<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StatsUp - Dashboard</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        neonGreen: '#39ff14',
                        darkBg: '#0f172a',
                    }
                }
            }
        }
    </script>
    
    <style>
        body {
            background-color: #0f172a;
            color: white;
            overflow-x: hidden;
        }
        /* Glassmorphism Genel Sınıfı */
        .glass {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        /* 3D Tilt Efekti için */
        #player-card, #chart-card {
            transform-style: preserve-3d;
            perspective: 1000px;
            transition: transform 0.1s ease-out;
        }
        /* Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #39ff14; }
    </style>
</head>
<body class="font-sans bg-[#0f172a] text-white antialiased">
    <script>
        if (localStorage.getItem('isLoggedIn') !== 'true') {
            // window.location.href = 'login.html';
        }
    </script>

    <nav class="fixed w-full z-50 top-0 start-0 border-b border-white/10 bg-slate-900/80 backdrop-blur-md">
        <div class="max-w-screen-xl flex flex-wrap items-center justify-between mx-auto p-4">
            <a href="dashboard.html" class="flex items-center space-x-3 rtl:space-x-reverse">
                <span class="self-center text-2xl font-bold whitespace-nowrap text-white">Stats<span class="text-neonGreen">Up</span></span>
            </a>
            <div class="hidden w-full md:block md:w-auto">
                <ul class="font-medium flex flex-col p-4 md:p-0 mt-4 border border-gray-100 rounded-lg md:flex-row md:space-x-8 rtl:space-x-reverse md:mt-0 md:border-0 items-center">
                    
                    <li>
                        <a href="dashboard.html" class="block py-2 px-3 text-neonGreen md:p-0 transition-colors" aria-current="page">Panelim</a>
                    </li>
                    
                    <li>
                        <a href="matches.html" class="block py-2 px-3 text-white hover:text-neonGreen md:p-0 transition-colors">Maçlarım</a>
                    </li>
                    <li>
                        <a href="stats.html" class="block py-2 px-3 text-white hover:text-neonGreen md:p-0 transition-colors">İstatistikler</a>
                    </li>
                    
                    <li>
                        <a href="team.html" class="block py-2 px-3 text-white hover:text-neonGreen md:p-0 transition-colors">Takımım</a>
                    </li>
                    
                    <li>
                        <button onclick="openBookingModal()" class="bg-neonGreen text-slate-900 font-bold rounded-full px-4 py-2 hover:bg-white transition-all shadow-lg shadow-neonGreen/20">
                            <i class="fa-solid fa-plus mr-2"></i>
                            Saha Kirala
                        </button>
                    </li>
                    
                    <li class="flex items-center gap-4">
                        <a href="profile.html" class="flex items-center text-white hover:text-neonGreen transition-colors">
                            <i class="fa-solid fa-user mr-2"></i> Profil
                        </a>
                        <button id="logoutBtn" class="text-red-500 hover:text-red-400 transition-colors">
                            <i class="fa-solid fa-sign-out-alt mr-2"></i> Çıkış Yap
                        </button>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <main class="pt-24 pb-12 px-4">
        <div class="container mx-auto max-w-6xl">
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-stretch mb-12">
                
                <div id="player-card" class="relative bg-slate-800 rounded-2xl border-2 border-neonGreen p-6 shadow-[0_0_20px_rgba(57,255,20,0.1)] flex flex-col items-center justify-center">
                    <div class="w-full flex justify-between items-start mb-4">
                        <div class="text-center">
                            <div class="text-4xl font-bold text-neonGreen">85</div>
                            <div class="text-xs text-gray-400 uppercase tracking-widest">GENEL</div>
                        </div>
                        <div class="bg-neonGreen text-slate-900 font-bold px-3 py-1 rounded text-sm">OS</div>
                    </div>
                    
                    <div class="relative w-32 h-32 mb-4 rounded-full border-4 border-slate-700 overflow-hidden shadow-lg">
                        <img src="profile-photo.jpg" alt="Profil" class="w-full h-full object-cover">
                    </div>
                    
                    <h2 class="text-2xl font-bold text-white mb-1" id="playerName">Yusuf Pekince</h2>
                    <p class="text-neonGreen text-sm mb-6">StatsUp Pro</p>
                    
                    <div class="grid grid-cols-3 gap-3 w-full">
                        <div class="bg-slate-900/50 p-2 rounded text-center border border-white/5">
                            <span class="block text-xs text-gray-400">HIZ</span>
                            <span class="text-lg font-bold text-white">82</span>
                        </div>
                        <div class="bg-slate-900/50 p-2 rounded text-center border border-white/5">
                            <span class="block text-xs text-gray-400">ŞUT</span>
                            <span class="text-lg font-bold text-white">86</span>
                        </div>
                        <div class="bg-slate-900/50 p-2 rounded text-center border border-white/5">
                            <span class="block text-xs text-gray-400">PAS</span>
                            <span class="text-lg font-bold text-white">88</span>
                        </div>
                        <div class="bg-slate-900/50 p-2 rounded text-center border border-white/5">
                            <span class="block text-xs text-gray-400">DRİ</span>
                            <span class="text-lg font-bold text-white">85</span>
                        </div>
                        <div class="bg-slate-900/50 p-2 rounded text-center border border-white/5">
                            <span class="block text-xs text-gray-400">DEF</span>
                            <span class="text-lg font-bold text-white">60</span>
                        </div>
                        <div class="bg-slate-900/50 p-2 rounded text-center border border-white/5">
                            <span class="block text-xs text-gray-400">FİZ</span>
                            <span class="text-lg font-bold text-white">74</span>
                        </div>
                    </div>
                </div>
                
                <div id="chart-card" class="relative bg-slate-800 rounded-2xl border-2 border-neonGreen p-6 shadow-[0_0_20px_rgba(57,255,20,0.1)] flex flex-col justify-center">
                    <h3 class="text-xl font-bold text-white mb-6 pl-2 border-l-4 border-neonGreen">Yetenek Analizi</h3>
                    <div class="flex-1 flex items-center justify-center relative w-full h-full min-h-[300px]">
                        <div class="w-full h-full flex items-center justify-center">
                            <canvas id="skillsChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-12">
                
                <div class="bg-slate-800 rounded-2xl border border-white/10 p-6 relative overflow-hidden group hover:border-neonGreen/50 transition-colors">
                    <div class="absolute top-0 right-0 p-4 opacity-10">
                        <i class="fa-solid fa-brain text-9xl text-neonGreen"></i>
                    </div>
                    <h3 class="text-xl font-bold text-white mb-6 flex items-center">
                        <i class="fa-solid fa-robot text-neonGreen mr-3"></i> AI Antrenör Analizi
                    </h3>
                    <div class="space-y-4 relative z-10">
                        <div class="flex items-start bg-slate-900/50 p-4 rounded-lg border-l-4 border-yellow-500">
                            <i class="fa-solid fa-battery-half text-yellow-500 mt-1 mr-3"></i>
                            <div>
                                <h4 class="text-white font-bold text-sm">Kondisyon Düşüşü</h4>
                                <p class="text-gray-400 text-xs mt-1">Son maçta 45. dakikadan sonra sprint sayın %40 azaldı. Dayanıklılık antrenmanına odaklan.</p>
                            </div>
                        </div>
                        <div class="flex items-start bg-slate-900/50 p-4 rounded-lg border-l-4 border-neonGreen">
                            <i class="fa-solid fa-bullseye text-neonGreen mt-1 mr-3"></i>
                            <div>
                                <h4 class="text-white font-bold text-sm">Bitiricilik Uzmanı</h4>
                                <p class="text-gray-400 text-xs mt-1">Ceza sahası dışından şut isabetin (%65) lig ortalamasının çok üzerinde. Şut çekmekten çekinme!</p>
                            </div>
                        </div>
                        <div class="flex items-start bg-slate-900/50 p-4 rounded-lg border-l-4 border-blue-500">
                            <i class="fa-solid fa-lightbulb text-blue-500 mt-1 mr-3"></i>
                            <div>
                                <h4 class="text-white font-bold text-sm">Oyun Kurucu</h4>
                                <p class="text-gray-400 text-xs mt-1">Pas trafiğinin merkezindesin. Takım arkadaşların en çok sana pas atıyor (42 Pas).</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="bg-slate-800 rounded-2xl border border-white/10 p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-bold text-white flex items-center">
                            <i class="fa-solid fa-trophy text-yellow-400 mr-3"></i> Haftanın En İyileri
                        </h3>
                        <button class="text-xs text-neonGreen hover:text-white transition-colors">Tüm Lig</button>
                    </div>
                    <div class="space-y-3">
                        <div class="flex items-center justify-between p-3 rounded-lg bg-slate-900/30 hover:bg-slate-900/50 transition-colors">
                            <div class="flex items-center gap-3">
                                <div class="w-8 h-8 flex items-center justify-center bg-yellow-500/20 text-yellow-500 font-bold rounded-full">1</div>
                                <img src="https://i.pravatar.cc/150?img=68" class="w-10 h-10 rounded-full border border-white/10">
                                <span class="text-white font-medium">Arda Turan</span>
                            </div>
                            <span class="text-yellow-400 font-bold">9.8</span>
                        </div>
                        <div class="flex items-center justify-between p-3 rounded-lg bg-neonGreen/10 border border-neonGreen/30 relative">
                            <div class="absolute -left-1 top-1/2 -translate-y-1/2 w-1 h-8 bg-neonGreen rounded-r"></div>
                            <div class="flex items-center gap-3">
                                <div class="w-8 h-8 flex items-center justify-center bg-neonGreen text-slate-900 font-bold rounded-full">2</div>
                                <img src="profile-photo.jpg" class="w-10 h-10 rounded-full border-2 border-neonGreen object-cover">
                                <div>
                                    <span class="text-white font-bold block">Yusuf Pekince</span>
                                    <span class="text-xs text-neonGreen">Sen</span>
                                </div>
                            </div>
                            <span class="text-neonGreen font-bold text-xl">9.6</span>
                        </div>
                        <div class="flex items-center justify-between p-3 rounded-lg bg-slate-900/30 hover:bg-slate-900/50 transition-colors">
                            <div class="flex items-center gap-3">
                                <div class="w-8 h-8 flex items-center justify-center bg-slate-700 text-gray-300 font-bold rounded-full">3</div>
                                <img src="https://i.pravatar.cc/150?img=12" class="w-10 h-10 rounded-full border border-white/10">
                                <span class="text-white font-medium">Sabri Sarıoğlu</span>
                            </div>
                            <span class="text-gray-300 font-bold">9.1</span>
                        </div>
                        <div class="flex items-center justify-between p-3 rounded-lg bg-slate-900/30 hover:bg-slate-900/50 transition-colors">
                            <div class="flex items-center gap-3">
                                <div class="w-8 h-8 flex items-center justify-center bg-slate-700 text-gray-300 font-bold rounded-full text-xs">4</div>
                                <img src="https://i.pravatar.cc/150?img=33" class="w-10 h-10 rounded-full border border-white/10">
                                <span class="text-gray-400 font-medium">Barış Alper Yılmaz</span>
                            </div>
                            <span class="text-gray-500 font-bold">8.7</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="bg-[#050914] border-t border-white/5 mt-12">
        <div class="container mx-auto px-4 py-8">
            <div class="text-center text-gray-500 text-sm">
                <p>&copy; 2025 <span class="text-neonGreen font-bold">StatsUp</span>. Tüm hakları saklıdır.</p>
            </div>
        </div>
    </footer>

    <div id="bookingModal" class="hidden fixed inset-0 z-[9999] flex items-center justify-center bg-black/90 backdrop-blur-sm p-4 font-sans">
        <div class="bg-slate-800 border border-white/10 rounded-2xl w-full max-w-4xl shadow-2xl overflow-hidden relative transform scale-95 opacity-0 flex flex-col max-h-[90vh]" id="bookingModalContent">
            
            <div class="bg-slate-900 p-6 flex justify-between items-center border-b border-white/10 shrink-0">
                <div>
                    <h3 class="text-2xl font-bold text-white flex items-center">
                        <i class="fa-solid fa-calendar-days text-neonGreen mr-3"></i>
                        Saha Rezervasyonu
                    </h3>
                    <p class="text-gray-400 text-sm mt-1">Konum, tarih ve saat seçimi yapınız.</p>
                </div>
                <button onclick="closeBookingModal()" class="text-gray-400 hover:text-white transition-colors w-10 h-10 flex items-center justify-center rounded-full hover:bg-white/10">
                    <i class="fa-solid fa-xmark text-2xl"></i>
                </button>
            </div>

            <div class="p-6 overflow-y-auto custom-scrollbar">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    
                    <div class="space-y-6">
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="text-gray-400 text-xs uppercase font-bold mb-2 block">Şehir <span class="text-red-500">*</span></label>
                                <select id="city-select" onchange="handleCityChange()" class="w-full bg-slate-900 border border-white/20 text-white rounded-xl px-4 py-3 outline-none focus:border-neonGreen transition-colors">
                                    <option value="" disabled selected>Seçiniz</option>
                                    <option value="34">İstanbul</option>
                                    <option value="06">Ankara</option>
                                    <option value="35">İzmir</option>
                                </select>
                            </div>
                            <div>
                                <label class="text-gray-400 text-xs uppercase font-bold mb-2 block">İlçe <span class="text-red-500">*</span></label>
                                <select id="district-select" onchange="handleDistrictChange()" class="w-full bg-slate-900 border border-white/20 text-white rounded-xl px-4 py-3 outline-none focus:border-neonGreen transition-colors disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                                    <option value="">Önce Şehir Seç</option>
                                </select>
                            </div>
                        </div>

                        <div>
                            <label class="text-gray-400 text-xs uppercase font-bold mb-3 block">Saha Tercihi <span class="text-red-500">*</span></label>
                            <div class="space-y-3" id="fields-container">
                                <div class="p-4 bg-slate-900/50 border border-white/10 border-dashed rounded-xl text-center text-gray-500 text-sm">
                                    Lütfen önce Şehir ve İlçe seçiniz.
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="space-y-6">
                        <div>
                            <h4 class="text-white font-bold border-l-4 border-blue-500 pl-3 mb-4">Tarih</h4>
                            <input type="date" id="booking-date" class="w-full bg-slate-900 border border-white/20 text-white rounded-xl px-4 py-3 focus:border-neonGreen outline-none cursor-pointer" onclick="this.showPicker()">
                        </div>

                        <div>
                            <h4 class="text-white font-bold border-l-4 border-purple-500 pl-3 mb-4">Saat</h4>
                            <div class="grid grid-cols-3 gap-2" id="time-slots-container">
                                <div class="col-span-3 p-4 text-center text-gray-500 text-sm italic">
                                    Saatleri görmek için bir saha seçin.
                                </div>
                            </div>
                        </div>
                        
                        <div id="selectedTimeInfo" class="hidden mt-4 p-4 bg-neonGreen/10 border border-neonGreen rounded-lg flex justify-between items-center animate-fade-in">
                            <div>
                                <p class="text-neonGreen text-xs uppercase font-bold">Seçilen Saat</p>
                                <p class="text-white font-bold text-lg" id="selectedTimeText">-</p>
                            </div>
                            <i class="fa-regular fa-clock text-neonGreen text-2xl"></i>
                        </div>
                    </div>
                </div>
            </div>

            <div class="bg-slate-900 p-6 border-t border-white/10 flex justify-between items-center shrink-0">
                <div>
                    <div class="text-xs text-gray-400 uppercase">Toplam Tutar</div>
                    <div class="text-2xl font-bold text-neonGreen" id="total-price">₺0</div>
                </div>
                <button onclick="confirmBooking()" class="bg-neonGreen text-slate-900 font-bold py-3 px-8 rounded-xl hover:bg-white hover:shadow-[0_0_20px_rgba(57,255,20,0.5)] transition-all flex items-center transform active:scale-95">
                    Ödemeye Geç <i class="fa-solid fa-arrow-right ml-2"></i>
                </button>
            </div>
        </div>
    </div>

    <div id="booking-toast" class="fixed top-24 right-4 z-[10000] bg-slate-800 border-l-4 border-neonGreen text-white p-4 rounded-lg shadow-2xl transform translate-x-full transition-transform duration-500 flex items-center gap-4">
        <div class="w-10 h-10 rounded-full bg-neonGreen/20 flex items-center justify-center text-neonGreen">
            <i class="fa-solid fa-check text-xl"></i>
        </div>
        <div>
            <h4 class="font-bold">Rezervasyon Başarılı!</h4>
            <p class="text-sm text-gray-300">Ödeme sayfasına yönlendiriliyorsunuz...</p>
        </div>
    </div>

    <script>
        // --- GRAFİK KODLARI (Chart.js) ---
        document.addEventListener('DOMContentLoaded', function() {
            // Kullanıcı adı
            const userName = localStorage.getItem('userName');
            if (userName) {
                const pn = document.getElementById('playerName');
                if(pn) pn.textContent = userName;
            }
            
            // Grafik Çizimi
            const ctx = document.getElementById('skillsChart').getContext('2d');
            const skillsChart = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['Hız', 'Şut', 'Pas', 'Dribling', 'Defans', 'Fizik'],
                    datasets: [{
                        label: 'Yetenek Puanları',
                        data: [82, 88, 90, 85, 60, 74],
                        backgroundColor: 'rgba(57, 255, 20, 0.2)',
                        borderColor: '#39ff14',
                        borderWidth: 2,
                        pointBackgroundColor: '#39ff14',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: '#39ff14',
                        pointRadius: 5,
                        pointHoverRadius: 7
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false, // ÖNEMLİ: Bu ayar grafiğin kutuya sığmasını sağlar
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 100,
                            ticks: { stepSize: 20, color: '#94a3b8', backdropColor: 'transparent' },
                            grid: { color: 'rgba(255, 255, 255, 0.1)' },
                            pointLabels: { color: '#ffffff', font: { size: 14, weight: 'bold' } }
                        }
                    },
                    plugins: { legend: { display: false } }
                }
            });
            
            // GSAP Animasyonları
            gsap.from('#player-card', { duration: 1, x: -100, opacity: 0, ease: 'power3.out', delay: 0.2 });
            gsap.from('#chart-card', { duration: 1, x: 100, opacity: 0, ease: 'power3.out', delay: 0.4 });
            
            // 3D Tilt
            function addTiltEffect(selector) {
                const element = document.querySelector(selector);
                if (!element) return;
                gsap.set(element, { transformStyle: "preserve-3d", transformPerspective: 1000 });
                element.addEventListener("mousemove", (e) => {
                    const bounds = element.getBoundingClientRect();
                    const mouseX = e.clientX;
                    const mouseY = e.clientY;
                    const leftX = mouseX - bounds.x;
                    const topY = mouseY - bounds.y;
                    const center = { x: leftX - bounds.width / 2, y: topY - bounds.height / 2 }
                    const distanceX = center.x / bounds.width;
                    const distanceY = center.y / bounds.height;
                    gsap.to(element, { rotationY: distanceX * 15, rotationX: -distanceY * 15, scale: 1.02, duration: 0.4, ease: "power2.out" });
                });
                element.addEventListener("mouseleave", () => {
                    gsap.to(element, { rotationY: 0, rotationX: 0, scale: 1, duration: 0.7, ease: "elastic.out(1, 0.5)" });
                });
            }
            addTiltEffect("#player-card");
            addTiltEffect("#chart-card");
        });

        document.getElementById('logoutBtn').addEventListener('click', function() {
            localStorage.removeItem('isLoggedIn');
            localStorage.removeItem('userName');
            window.location.href = 'login.html';
        });

        // --- REZERVASYON MODALI SCRIPT ---
        const locationDB = { "34": ["Kadıköy", "Beşiktaş", "Şişli", "Ümraniye"], "06": ["Çankaya", "Keçiören", "Yenimahalle"], "35": ["Konak", "Karşıyaka", "Bornova"] };
        const fieldsDB = {
            "Kadıköy": [{ id: "k1", name: "Kadıköy Arena", type: "Kapalı", turf: "Suni Çim", players: "7v7", price: 1400, img: "https://images.unsplash.com/photo-1529900748604-07564a03e7a6?ixlib=rb-1.2.1&auto=format&fit=crop&w=200&q=80" }, { id: "k2", name: "Moda Park", type: "Açık", turf: "Hibrit", players: "8v8", price: 1200, img: "https://images.unsplash.com/photo-1459865264687-595d652de67e?ixlib=rb-1.2.1&auto=format&fit=crop&w=200&q=80" }],
            "Beşiktaş": [{ id: "b1", name: "Kartal Yuvası", type: "Kapalı", turf: "Doğal Çim", players: "6v6", price: 1600, img: "https://images.unsplash.com/photo-1575361204480-aadea25e6e68?ixlib=rb-1.2.1&auto=format&fit=crop&w=200&q=80" }],
            "Çankaya": [{ id: "c1", name: "Ankara Gücü", type: "Kapalı", turf: "Suni", players: "7v7", price: 1000, img: "https://images.unsplash.com/photo-1524012431247-53c4ca003c56?ixlib=rb-1.2.1&auto=format&fit=crop&w=200&q=80" }],
            "default": [{ id: "d1", name: "Merkez Saha", type: "Kapalı", turf: "Suni", players: "7v7", price: 1100, img: "https://images.unsplash.com/photo-1529900748604-07564a03e7a6?ixlib=rb-1.2.1&auto=format&fit=crop&w=200&q=80" }]
        };
        const schedulesDB = {
            "k1": [{t:"18:00", f:true}, {t:"19:00", f:true}, {t:"20:00", f:false}, {t:"21:00", f:false}, {t:"22:00", f:true}, {t:"23:00", f:false}],
            "k2": [{t:"18:00", f:false}, {t:"19:00", f:false}, {t:"20:00", f:true}, {t:"21:00", f:true}, {t:"22:00", f:false}, {t:"23:00", f:false}],
            "default": [{t:"18:00", f:false}, {t:"19:00", f:true}, {t:"20:00", f:false}, {t:"21:00", f:false}, {t:"22:00", f:true}, {t:"23:00", f:false}]
        };
        let state = { city: null, district: null, fieldId: null, fieldPrice: 0, time: null };

        function openBookingModal() { document.getElementById('bookingModal').classList.remove('hidden'); const d = document.getElementById('booking-date'); if(!d.value) d.valueAsDate = new Date(); gsap.to('#bookingModalContent', { scale: 1, opacity: 1, duration: 0.3, ease: "back.out(1.2)" }); }
        function closeBookingModal() { gsap.to('#bookingModalContent', { scale: 0.95, opacity: 0, duration: 0.2, onComplete: () => { document.getElementById('bookingModal').classList.add('hidden'); document.getElementById('bookingModalContent').style = ""; }}); }
        function handleCityChange() { const c = document.getElementById('city-select').value; const d = document.getElementById('district-select'); state = { city: c, district: null, fieldId: null, fieldPrice: 0, time: null }; updateUI(); d.innerHTML = '<option value="">İlçe Seçiniz</option>'; if(c && locationDB[c]) { d.disabled = false; locationDB[c].forEach(x => d.innerHTML += `<option value="${x}">${x}</option>`); } else { d.disabled = true; d.innerHTML = '<option value="">Önce Şehir Seç</option>'; } }
        function handleDistrictChange() { const dist = document.getElementById('district-select').value; state.district = dist; state.fieldId = null; state.fieldPrice = 0; state.time = null; updateUI(); renderFields(dist); }
        function renderFields(dist) { const c = document.getElementById('fields-container'); const f = fieldsDB[dist] || fieldsDB["default"]; c.innerHTML = ''; f.forEach(x => { c.innerHTML += `<div onclick="selectPitch('${x.id}', ${x.price})" id="field-${x.id}" class="pitch-card cursor-pointer bg-slate-900 border-2 border-transparent rounded-xl p-3 flex gap-4 transition-all hover:bg-slate-700 relative overflow-hidden group opacity-80"><div class="w-20 h-20 bg-cover bg-center rounded-lg flex-shrink-0" style="background-image: url('${x.img}');"></div><div class="flex-grow"><div class="flex justify-between items-start"><h5 class="text-white font-bold">${x.name} (${x.type})</h5><i class="fa-solid fa-circle text-gray-600 check-icon text-xl"></i></div><p class="text-gray-400 text-xs mt-1">${x.turf} • ${x.players}</p><div class="mt-2 text-neonGreen font-bold text-sm">₺${x.price} / Saat</div></div></div>`; }); gsap.from('.pitch-card', { y: 10, opacity: 0, duration: 0.4, stagger: 0.1 }); }
        function selectPitch(id, price) { state.fieldId = id; state.fieldPrice = price; state.time = null; document.querySelectorAll('.pitch-card').forEach(e => { e.className = e.className.replace('bg-slate-800 border-neonGreen opacity-100 shadow-lg', 'bg-slate-900 border-transparent opacity-80'); e.querySelector('.check-icon').className = "fa-solid fa-circle text-gray-600 check-icon text-xl"; }); const s = document.getElementById(`field-${id}`); s.className = s.className.replace('bg-slate-900 border-transparent opacity-80', 'bg-slate-800 border-neonGreen opacity-100 shadow-lg'); s.querySelector('.check-icon').className = "fa-solid fa-circle-check text-neonGreen check-icon text-xl"; updateUI(); renderTimeSlots(id); }
        function renderTimeSlots(fid) { const c = document.getElementById('time-slots-container'); const s = schedulesDB[fid] || schedulesDB["default"]; c.innerHTML = ''; s.forEach(x => { const b = document.createElement('button'); if(x.f) { b.className = "p-2 rounded-lg bg-red-900/20 border border-red-500/30 text-red-500 text-xs cursor-not-allowed opacity-60"; b.innerHTML = `${x.t} <br><span class="font-bold">DOLU</span>`; b.disabled = true; } else { b.className = "time-btn p-3 rounded-lg bg-slate-900 border border-white/10 text-gray-300 text-xs hover:border-neonGreen hover:text-white transition-all"; b.innerText = x.t; b.onclick = () => selectTime(b, x.t); } c.appendChild(b); }); gsap.from('#time-slots-container button', { scale: 0.8, opacity: 0, duration: 0.3, stagger: 0.05 }); }
        function selectTime(btn, t) { state.time = t; document.querySelectorAll('.time-btn').forEach(b => b.className = "time-btn p-3 rounded-lg bg-slate-900 border border-white/10 text-gray-300 text-xs hover:border-neonGreen hover:text-white transition-all"); btn.className = "time-btn p-3 rounded-lg bg-neonGreen text-slate-900 font-bold text-xs shadow-[0_0_10px_#39ff14]"; updateUI(); }
        function updateUI() { document.getElementById('total-price').innerText = `₺${state.fieldPrice}`; const i = document.getElementById('selectedTimeInfo'); if(state.time) { i.classList.remove('hidden'); document.getElementById('selectedTimeText').innerText = state.time; } else { i.classList.add('hidden'); } }
        function confirmBooking() { if(!state.city) { alert("Lütfen bir ŞEHİR seçiniz."); return; } if(!state.district) { alert("Lütfen bir İLÇE seçiniz."); return; } if(!state.fieldId) { alert("Lütfen SAHA seçiniz."); return; } if(!state.time) { alert("Lütfen SAAT seçiniz."); return; } closeBookingModal(); const t = document.getElementById('booking-toast'); t.style.transform = "translateX(0)"; setTimeout(() => t.style.transform = "translateX(150%)", 3000); }
    </script>
</body>
</html>